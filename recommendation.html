<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>èœå“æ¨èæµç¨‹</title>
<style>
  body {
    margin: 0;
    font-family: Arial, 'Microsoft YaHei', sans-serif;
    min-height: 100vh;
    background: url('./images/dishes-2.jpeg') center/cover fixed;
    position: relative;
    color: #333;
  }
  body::before {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0; bottom: 0;
    background: inherit;
    filter: blur(8px) brightness(1.1);
    z-index: -1;
  }
  .page { display:none; padding:20px; text-align:center; }
  .page.active { display:block; }
  .camera-area {
    width:300px; height:300px; background:#fff; border-radius:24px;
    margin:1rem auto; overflow:hidden; position:relative;
  }
  #video { width:100%; height:100%; object-fit:cover; }
  #capture-canvas { display:none; }
  .header {
    display:flex; align-items:center; justify-content:space-between;
    padding:10px; background:#f5f5e6; border-bottom:1px solid #ddd;
  }
  .header .title { font-weight:bold; }
  .icon-btn { background:none; border:none; font-size:1.2rem; cursor:pointer; }

  /* swiper */
  .swiper { display:flex; width:300%; transition:transform 0.4s ease; }
  .slide { width:100%; box-sizing:border-box; padding:20px; }
  .result-container { display:flex; justify-content:center; align-items:center; gap:20px; flex-wrap:nowrap; }
  #result-photo,#fortune-photo {
    width:200px;
    height:200px;
    border-radius:20px;
    object-fit:cover;
  }
  .info-panel { background:rgba(255,255,255,0.9); padding:1rem; border-radius:10px; text-align:left; min-width:200px; }
  .attr-table { width:100%; border-collapse:collapse; }
  .attr-table td { padding:4px 6px; border-bottom:1px solid #ccc; }
  .chart { margin-top:0.5rem; }
  .bar-row { display:flex; align-items:center; margin-bottom:6px; font-size:0.9rem; }
  .bar-label { width:60px; }
  .bar-container { flex:1; background:#eee; height:8px; border-radius:4px; margin:0 5px; }
  .bar { height:100%; background:#4CAF50; border-radius:4px; }
  .bar-value { width:30px; text-align:right; font-size:0.8rem; }
  #retry-btn { margin-top:20px; }

  .fortune-panel div { margin-bottom:6px; }
  .color-box { display:inline-block; width:20px; height:20px; border-radius:4px; vertical-align:middle; margin-right:6px; }

  .cards { display:flex; gap:10px; overflow-x:auto; padding-bottom:10px; }
  .dish-card { background:#fff; border-radius:10px; width:150px; flex-shrink:0; }
  .dish-card img { width:100%; height:100px; object-fit:cover; border-radius:10px 10px 0 0; }
  .dish-card .dish-title { padding:6px; font-size:0.9rem; }
  .buttons { display:flex; justify-content:center; gap:10px; margin-top:20px; }
  .outline-btn { border:1px solid #8b4513; background:none; color:#8b4513; padding:8px 16px; border-radius:6px; cursor:pointer; }

  .pager { text-align:center; margin-top:10px; }
  .dot { display:inline-block; width:8px; height:8px; border-radius:50%; background:#ccc; margin:0 3px; }
  .dot.active { background:#666; }
</style>
</head>
<body>
<div id="capture-page" class="page active">
  <h1>èœå“æ¨è</h1>
  <div class="camera-area">
    <video id="video" autoplay muted playsinline></video>
    <canvas id="capture-canvas"></canvas>
  </div>
  <button id="capture-btn">ç‚¹å‡»æ‹ç…§</button>
</div>

<div id="result-page" class="page">
  <div class="header">
    <button id="back-btn" class="icon-btn">â†</button>
    <span class="title">èœå“æ¨è</span>
    <div>
      <button class="icon-btn">ğŸ‘¤</button>
      <button class="icon-btn">ğŸ”—</button>
    </div>
  </div>
  <div id="swiper" class="swiper">
    <div class="slide" id="slide-analysis">
      <div class="result-container">
        <img id="result-photo" />
        <div id="analysis-results" class="info-panel"></div>
      </div>
      <button id="retry-btn">é‡è¯•ä¸€æ¬¡</button>
    </div>
    <div class="slide" id="slide-fortune">
      <div class="result-container">
        <img id="fortune-photo" />
        <div id="fortune-results" class="info-panel fortune-panel"></div>
      </div>
    </div>
    <div class="slide" id="slide-dish">
      <div class="cards" id="dish-cards"></div>
      <div class="buttons">
        <button class="outline-btn">æˆ‘å·²é€‰å¥½ï¼Œä¸€é”®å¼€åƒ</button>
        <button class="outline-btn">å¡«å†™ä¸ªäººä¿¡æ¯ï¼Œæ¨èæ›´ç²¾å‡†</button>
      </div>
    </div>
  </div>
  <div class="pager">
    <span class="dot active"></span>
    <span class="dot"></span>
    <span class="dot"></span>
  </div>
</div>

<script>
let mediaStream = null;
const capturePage = document.getElementById('capture-page');
const resultPage = document.getElementById('result-page');
const video = document.getElementById('video');
const canvas = document.getElementById('capture-canvas');
const captureBtn = document.getElementById('capture-btn');
const resultPhoto = document.getElementById('result-photo');
const fortunePhoto = document.getElementById('fortune-photo');
const analysisResults = document.getElementById('analysis-results');
const fortuneResults = document.getElementById('fortune-results');
const dishCards = document.getElementById('dish-cards');
const retryBtn = document.getElementById('retry-btn');
const backBtn = document.getElementById('back-btn');
const swiper = document.getElementById('swiper');
const dots = document.querySelectorAll('.dot');
let currentSlide = 0;
let photoData = '';
let latestFaceInfo = null;

function showPage(p){ capturePage.classList.remove('active'); resultPage.classList.remove('active'); p.classList.add('active'); }

async function initCamera(){
  try{
    mediaStream = await navigator.mediaDevices.getUserMedia({video:{facingMode:'user'}});
    video.srcObject = mediaStream;
    await video.play();
  }catch(e){
    alert('æ— æ³•è®¿é—®æ‘„åƒå¤´');
  }
}

function stopCamera(){
  if(mediaStream){
    mediaStream.getTracks().forEach(t=>t.stop());
    mediaStream = null;
    video.srcObject = null;
  }
}

function showSlide(i){
  currentSlide = Math.max(0, Math.min(i, 2));
  swiper.style.transform = `translateX(-${currentSlide*100}%)`;
  dots.forEach((d,idx)=>d.classList.toggle('active', idx===currentSlide));
}

let startX=0;
swiper.addEventListener('touchstart',e=>{startX=e.touches[0].clientX;});
swiper.addEventListener('touchend',e=>{
  const dx=e.changedTouches[0].clientX-startX;
  if(dx>50) showSlide(currentSlide-1); else if(dx<-50) showSlide(currentSlide+1);
});

dots.forEach((dot,idx)=>dot.addEventListener('click',()=>showSlide(idx)));

captureBtn.onclick = async () => {
  if(!mediaStream) await initCamera();
  if(video.readyState < 2){
    await new Promise(r => video.onloadedmetadata = () => r());
  }
  canvas.width = video.videoWidth;
  canvas.height = video.videoHeight;
  const ctx = canvas.getContext('2d');
  ctx.drawImage(video,0,0,canvas.width,canvas.height);
  photoData = canvas.toDataURL('image/jpeg');
  stopCamera();
  resultPhoto.src = photoData;
  fortunePhoto.src = photoData;
  showPage(resultPage);
  showSlide(0);
  const blob = await (await fetch(photoData)).blob();
  const detect = await detectFaces(blob);
  renderFace(detect);
  const text = await callGPT(buildPrompt(latestFaceInfo,{}));
  if(text){
    try{
      const obj = JSON.parse(text);
      renderFortune(obj.metaphysics||{}, obj.face_summary, obj.mood_summary);
      renderDishes(obj.recommendations||[]);
    }catch(e){
      fortuneResults.textContent = text;
    }
  }
};

retryBtn.onclick = () => { showPage(capturePage); initCamera(); };
backBtn.onclick = () => { showPage(capturePage); initCamera(); };

async function detectFaces(imageBlob){
  const formData = new FormData();
  formData.append('api_key','mSptsjK7hxWAuKyOGmTjQAhYwJ2MaCJJ');
  formData.append('api_secret','vcBaU1AknR9S_NgPnc8oZGrEn-H-_NOk');
  formData.append('image_file',imageBlob,'photo.jpg');
  formData.append('return_attributes','gender,age,smiling,emotion,skinstatus');
  const resp = await fetch('https://api-cn.faceplusplus.com/facepp/v3/detect',{
    method:'POST',
    body:formData
  });
  const data = await resp.json();
  if(data.faces && data.faces.length){
    const attr = data.faces[0].attributes;
    latestFaceInfo = {gender:attr.gender.value, age:attr.age.value, smile:attr.smile.value, emotion:attr.emotion, skin:attr.skinstatus};
  }
  return data;
}

const EMOTION_MAP = {anger:'æ„¤æ€’', disgust:'åŒæ¶', fear:'ææƒ§', happiness:'é«˜å…´', neutral:'å¹³é™', sadness:'ä¼¤å¿ƒ', surprise:'æƒŠè®¶'};
const SKIN_MAP = {health:'å¥åº·', stain:'è‰²æ–‘', dark_circle:'é»‘çœ¼åœˆ', acne:'é’æ˜¥ç—˜'};

function barRows(obj,map={}){
  let html='';
  for(const k in obj){
    const v=obj[k];
    const label=map[k]||k;
    html += `<div class="bar-row"><span class="bar-label">${label}</span><div class="bar-container"><div class="bar" style="width:${v}%"></div></div><span class="bar-value">${v.toFixed(1)}</span></div>`;
  }
  return html;
}

function renderFace(data){
  if(!data || !data.faces || !data.faces.length){ analysisResults.textContent='æœªæ£€æµ‹åˆ°äººè„¸'; return; }
  const a=data.faces[0].attributes;
  let html='<table class="attr-table">';
  html+=`<tr><td>æ€§åˆ«</td><td>${a.gender.value}</td></tr>`;
  html+=`<tr><td>å¹´é¾„</td><td>${a.age.value}</td></tr>`;
  html+=`<tr><td>å¾®ç¬‘åº¦</td><td>${a.smile.value.toFixed(2)}%</td></tr>`;
  html+='</table>';
  if(a.emotion) html+=`<div class="chart"><h3>æƒ…ç»ªåˆ†å¸ƒ</h3>${barRows(a.emotion,EMOTION_MAP)}</div>`;
  if(a.skinstatus) html+=`<div class="chart"><h3>çš®è‚¤çŠ¶æ€</h3>${barRows(a.skinstatus,SKIN_MAP)}</div>`;
  analysisResults.innerHTML=html;
}

function renderFortune(meta, faceSummary='', moodSummary=''){
  let html='';
  if(meta.lucky_color){ html+=`<div>å¹¸è¿è‰²ï¼š<span class="color-box" style="background:${meta.lucky_color}"></span>${meta.lucky_color}</div>`; }
  if(meta.guardian_star) html+=`<div>å®ˆæŠ¤æ˜Ÿï¼š${meta.guardian_star}</div>`;
  if(meta.five_elements_food) html+=`<div>äº”è¡Œè°ƒå’Œï¼š${meta.five_elements_food}</div>`;
  if(meta.today_yi) html+=`<div>å®œï¼š${meta.today_yi}</div>`;
  if(meta.today_ji) html+=`<div>å¿Œï¼š${meta.today_ji}</div>`;
  if(meta.lucky_number) html+=`<div>å¹¸è¿æ•°å­—ï¼š${meta.lucky_number}</div>`;
  html+=`<div>æ—¥æœŸï¼š${new Date().toLocaleDateString()}</div>`;
  if(faceSummary) html+=`<div>${faceSummary}</div>`;
  if(moodSummary) html+=`<div>${moodSummary}</div>`;
  fortuneResults.innerHTML=html;
}

function renderDishes(list){
  const titles=['å¹¸è¿è‰²æ¨è','é¢éƒ¨çŠ¶æ€è°ƒç†','æƒ…ç»ªè°ƒç†','èŠ‚æ°”ç‰¹è‰²é£Ÿæ'];
  dishCards.innerHTML='';
  list.slice(0,4).forEach((d,i)=>{
    const card=document.createElement('div');
    card.className='dish-card';
    const img=document.createElement('img');
    img.src='./images/dishes.jpeg';
    const title=document.createElement('div');
    title.className='dish-title';
    title.textContent=`${titles[i]||''} - ${d.dish||''}`;
    card.appendChild(img); card.appendChild(title);
    dishCards.appendChild(card);
  });
}

const PROMPT_TEMPLATE = `ä½ æ˜¯ã€ŒAIé¢ç›¸ç„å­¦è¥å…»æ¨èå¸ˆã€ï¼Œèåˆé¢éƒ¨è¯†åˆ«ç»“æœã€ç”¨æˆ·å¡«å†™é—®å·ä¿¡æ¯ã€ç°ä»£è¥å…»ç§‘å­¦ä¸ä¸œæ–¹ç„å­¦ï¼Œä¸ºCç«¯ç”¨æˆ·ç”Ÿæˆè¶£å‘³ã€ç²¾å‡†ã€ä¸ªæ€§åŒ–çš„åˆé¤æ¨èå»ºè®®ã€‚

ä½ çš„ä»»åŠ¡ï¼š
- è¾“å…¥æ•°æ®ï¼šé¢éƒ¨è¯†åˆ«æ•°æ®ï¼ˆå¿…å¡«ï¼‰+ ç”¨æˆ·é—®å·ä¿¡æ¯ï¼ˆé€‰å¡«ï¼‰
- è¾“å‡ºä¸¥æ ¼ç»“æ„åŒ–çš„JSONæ ¼å¼ï¼Œä¾›å‰ç«¯ç³»ç»Ÿè§£æå±•ç¤ºï¼›
- å†…å®¹é€»è¾‘ç»“åˆé¢éƒ¨å›¾åƒåˆ†æä¸ç”¨æˆ·ä¸ªæ€§åŒ–å¡«å†™ä¿¡æ¯ï¼›
- ä¿æŒåˆ›é€ æ€§è¡¨è¾¾ï¼Œé¿å…æ¨¡æ¿é‡å¤ï¼Œç¡®ä¿æ¯æ—¥è¾“å‡ºæœ‰æ–°é²œæ„Ÿã€ç¤¾äº¤ä¼ æ’­æ€§å’Œå¨±ä¹ä½“éªŒã€‚
---

ã€è¾“å…¥æ•°æ®ã€‘

### å¿…å¡«è¾“å…¥ï¼ˆé¢éƒ¨è¯†åˆ«æ¥å£æä¾›ï¼Œå§‹ç»ˆå­˜åœ¨ï¼‰
[FACE_JSON]

é€‰å¡«è¾“å…¥ï¼ˆç”¨æˆ·é—®å·ä¿¡æ¯ï¼Œéƒ¨åˆ†æˆ–å…¨éƒ¨å¯èƒ½ç¼ºçœï¼‰
[USER_JSON]

ä½ éœ€è¦ç»“åˆå¿…å¡«çš„é¢éƒ¨è¯†åˆ«ç»“æœï¼Œä¸é€‰å¡«çš„ç”¨æˆ·ä¿¡æ¯é—®å·ï¼Œæ•´åˆç”Ÿæˆé¥®é£Ÿæ¨èç»“æœã€‚é€‰å¡«é—®å·ä¿¡æ¯å¦‚æœç¼ºå¤±ï¼Œå¯ä»…åŸºäºé¢éƒ¨è¯†åˆ«æ•°æ®ç‹¬ç«‹å®Œæˆç”Ÿæˆï¼›åŸåˆ™å¦‚ä¸‹ï¼š

å¡«å†™çš„ä¿¡æ¯è¶Šå¤šï¼Œå†…å®¹åº”ä½“ç°è¶Šä¸°å¯Œä¸ªæ€§åŒ–ï¼›

é€»è¾‘ä¸°å¯Œï¼Œä½†è¾“å‡ºéœ€çµæ´»å¤šæ ·ï¼Œä¸å¾—å›ºå®šæ¨¡æ¿æ­»æ¿è¾“å‡ºï¼›

ä¿ç•™å……åˆ†åˆ›é€ ç©ºé—´ï¼Œä½“ç°AIçš„åˆ›é€ åŠ›ä¸å¨±ä¹æ€§ã€‚

ä¸€ã€å„å­—æ®µç”Ÿæˆè¯´æ˜
1. metaphysicsï¼ˆç„å­¦ä¿¡æ¯ï¼‰
lucky_colorï¼šç»¼åˆé¢éƒ¨çŠ¶æ€ã€æƒ…ç»ªè¡¨ç°ã€è¿‘æœŸå…³æ³¨æ–¹å‘ã€è¡€å‹ç­‰è‡ªç”±å‘æŒ¥ï¼Œå‚è€ƒäº”è¡Œè‰²ç³»ï¼ˆé‡‘ç™½é“¶ã€æœ¨é’ç»¿ã€æ°´é»‘è“ã€ç«çº¢æ©™ç´«ã€åœŸé»„æ£•ï¼‰ã€‚
lucky_numberï¼šç»“åˆå¹´é¾„ã€æƒ…ç»ªã€å¥åº·ç›®æ ‡ã€ç„å­¦è¯‰æ±‚ç­‰ç”Ÿæˆæœ‰ç§¯æå¯“æ„çš„å¹¸è¿æ•°å­—ï¼ˆ1-9ï¼‰ã€‚
guardian_starï¼šç»“åˆç”Ÿæ—¥ã€è¡€å‹ã€ç„å­¦è¯‰æ±‚ï¼Œè‡ªç”±è®¾å®šä¸œæ–¹ç„å­¦æˆ–è¶£å‘³å®ˆæŠ¤æ˜Ÿï¼ˆå¦‚ï¼šç´«å¾®ã€æ–‡æ˜Œã€å¤©å–œã€ç¦å¾·ã€æ‹›è´¢çŒ«ç­‰ï¼‰ã€‚
five_elements_foodï¼šç”Ÿæˆä»Šæ—¥å®œé£Ÿäº”è¡Œæ­é…æè¿°ï¼ˆå¦‚ï¼šæ°´æœ¨åŒä¿® æ¸…ç«å…»é¢œï¼‰ã€‚
today_yi / today_jiï¼šé¥®é£Ÿä¸æƒ…ç»ªä¸Šçš„å®œå¿Œæç¤ºï¼Œè¯­è¨€å¯å¹½é»˜è½»æ¾ã€‚

2. face_summaryï¼ˆé¢ç›¸ç„å­¦è§£è¯»ï¼‰
èåˆé¢éƒ¨çš®è‚¤æŒ‡æ ‡ã€å¾®ç¬‘åº¦ã€æ°”åœºç”Ÿæˆè¶£å‘³é¢ç›¸è§£è¯»è¯­ã€‚

3. mood_summaryï¼ˆå¿ƒæƒ…è§£è¯»ï¼‰
ç»¼åˆé¢éƒ¨æƒ…ç»ªä¸è‡ªå¡«ä»Šæ—¥å¿ƒæƒ…è‡ªç”±ç”Ÿæˆï¼Œè¯­è¨€äº²åˆ‡è½»æ¾ã€‚

4. recommendationsï¼ˆèœå“æ¨èï¼‰
æ¯æ¬¡è¾“å‡º 4 é“èœå“ï¼Œæ¯é“èœå“åŒ…å«ï¼š

dishï¼šå…·ä½“èœå“åç§°ï¼›
fun_commentï¼šè½»æ¾å¹½é»˜ä¿çš®çš„è¶£å‘³æ–‡æ¡ˆï¼Œå¯æŠ¼éŸµå¯åŠ emojiï¼›
metaphysics_reasonï¼šç„å­¦èƒŒä¹¦é€»è¾‘ï¼›
nutrition_valueï¼šé€šä¿—è¥å…»äº®ç‚¹ï¼›
seasonal_reasonï¼šèŠ‚æ°”æˆ–æ—¶ä»¤åˆç†æ€§ã€‚

èœå“é€»è¾‘åˆ†å¸ƒï¼š
ç¬¬ä¸€èœï¼šå¹¸è¿è‰²å‘¼åº”é£Ÿæï¼›
ç¬¬äºŒèœï¼šé¢éƒ¨çš®è‚¤è°ƒç†é£Ÿæï¼›
ç¬¬ä¸‰èœï¼šå¥åº·ç›®æ ‡&æƒ…ç»ªç–—æ„ˆé£Ÿæï¼›
ç¬¬å››èœï¼šèŠ‚æ°”æ—¶ä»¤é£Ÿæã€‚

éœ€æ³¨æ„ï¼š
é£Ÿæéœ€ç¬¦åˆç”¨æˆ·å¿Œå£é™åˆ¶ï¼›
å……åˆ†ä½“ç°å¥åº·ç›®æ ‡ï¼ˆå¦‚å‡è„‚â†’æ§æ²¹é«˜è›‹ç™½ï¼Œå¢è‚Œâ†’è¡¥è›‹ç™½ï¼ŒæŠ¤èƒƒâ†’è½¯çƒ‚æ¸…æ·¡ï¼‰ï¼›
ç»“åˆæ´»åŠ¨é‡ä¸å½“å‰èƒ½é‡ä»£è°¢éœ€æ±‚åŒ¹é…æ¨èã€‚

5. personalized_insightï¼ˆä¸ªäººä¸“å±é”¦å›Šï¼‰
health_tipï¼šä¸ªæ€§åŒ–å¥åº·å»ºè®®ï¼›
energy_tipï¼šæ°”åœºèƒ½é‡æé†’ï¼›
fortune_tipï¼šè¿åŠ¿ç„å­¦é”¦å›Šã€‚

6ï¸. closing_quoteï¼ˆç»“å°¾ç¥ç¦ï¼‰
ä¸€å¥é€‚åˆç¤¾äº¤åˆ†äº«çš„è½»æ¾ç»“è¯­ã€‚

ã€ç‰¹åˆ«æé†’ã€‘
é™¤ JSON ç»“æ„ä¹‹å¤–ä¸¥ç¦è¾“å‡ºä»»ä½•å¤šä½™æ–‡å­—ï¼›
ä¿è¯è¾“å‡ºå†…å®¹æ¯æ—¥æœ‰æ–°é²œæ„Ÿï¼Œé¿å…æ¨¡æ¿å¥—è·¯å¼ç»“æœï¼›
é£æ ¼æ•´ä½“ä¿æŒå¹´è½»åŒ–ã€è¶£å‘³ç„å­¦ã€æ­£èƒ½é‡ã€ç¤¾äº¤ä¼ æ’­æ„Ÿæå¼ºã€‚

ã€è¾“å‡ºæ ¼å¼è¦æ±‚ã€‘
è¯·ä¸¥æ ¼æŒ‰ç…§å¦‚ä¸‹ç»“æ„åŒ–JSONæ ¼å¼è¾“å‡ºï¼Œå­—æ®µé¡ºåºã€å±‚çº§ã€å‘½åå¿…é¡»ä¸€è‡´ã€‚é™¤JSONä¹‹å¤–ä¸å¾—è¾“å‡ºä»»ä½•å…¶ä»–æ–‡å­—ã€‚

{
  "metaphysics": {
    "lucky_color": "",
    "lucky_number": "",
    "guardian_star": "",
    "five_elements_food": "",
    "today_yi": "",
    "today_ji": ""
  },
  "face_summary": "",
  "mood_summary": "",
  "recommendations": [
    {
      "dish": "",
      "fun_comment": "",
      "metaphysics_reason": "",
      "nutrition_value": "",
      "seasonal_reason": ""
    },
    {
      "dish": "",
      "fun_comment": "",
      "metaphysics_reason": "",
      "nutrition_value": "",
      "seasonal_reason": ""
    },
    {
      "dish": "",
      "fun_comment": "",
      "metaphysics_reason": "",
      "nutrition_value": "",
      "seasonal_reason": ""
    },
    {
      "dish": "",
      "fun_comment": "",
      "metaphysics_reason": "",
      "nutrition_value": "",
      "seasonal_reason": ""
    }
  ],
  "personalized_insight": {
    "health_tip": "",
    "energy_tip": "",
    "fortune_tip": ""
  },
  "closing_quote": "",
  "disclaimer": "AIé£Ÿç–—å»ºè®®ï¼Œä»…ä¾›å¨±ä¹å‚è€ƒ"
}`;

function buildPrompt(face,user){
  return PROMPT_TEMPLATE.replace('[FACE_JSON]', JSON.stringify(face))
                        .replace('[USER_JSON]', JSON.stringify(user||{}));
}
const DASHSCOPE_API_KEY = 'sk-2487917f84dd4a948891b51a22a0832e';
async function callGPT(prompt){
  const resp = await fetch('https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions',{
    method:'POST',
    headers:{ 'Content-Type':'application/json','Authorization':'Bearer '+DASHSCOPE_API_KEY },
    body:JSON.stringify({ model:'deepseek-r1', messages:[{role:'user',content:prompt}] })
  });
  const data = await resp.json();
  return data.choices && data.choices[0].message.content;
}

document.addEventListener('DOMContentLoaded', () => {
  initCamera();
});
</script>
</body>
</html>
